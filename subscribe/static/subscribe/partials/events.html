<div class="alert alert-danger" ng-show="alert">
    <button class="close" ng-click="closeAlert()" aria-hidden="true" data-dismiss="alert" type="button">×</button>
    <strong>{{alert.title}}</strong><br>
    {{alert.message}}
</div>
<div class="row">
    <div ng-repeat="(id, slotEvent) in slotEvents" class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
        <div class="panel panel-info">
            <div class="panel-heading">
                <h4>Il tuo evento di {{slotEvent}}</h4>
            </div>
            <div class="panel-body" data-slotid="{{id}}" x-lvl-drop-target="true" x-on-drop="dropped(dragEl, dropEl)">
                <h4 style="pointer-events: none;" ng-hide="slotEvent">Non sei iscritto a nessun evento in questo turno</h4>
                <div style="pointer-events: none;" class="well" ng-show="slotEvent">
                    <p>Partecipi già all'evento "{{slotEvent.name}}" in questo turno</p>
                    <p style="text-align: center;">
                        <button style="pointer-events: auto;" class="btn btn-xs btn-danger" ng-click="removeSlotEvent(id,slotEvent)" type="button">Unsubscribe</button>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
        <div class="event tav label">Events in purple are TAV</div>
        <div class="event lab label">Events in yellow are LAB</div>
    </div>
</div>
<div class="row">
    <div ng-repeat="(id, slotEvent) in slotEvents" class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <h3>Eventi Slot {{id}}</h3>
        <div class="well" ng-show="slotEvents[id]">Partecipi già ad un evento di questo turno</div>
        <div class="well" ng-show="getEventsForTimeslot(id).length===0">Non ci sono eventi in questo slot</div>
        <table id="events" ng-hide="slotEvents[id] || getEventsForTimeslot(id).length===0" ng-table="getTableParams(id)" class="table table-bordered" cellspacing="0" width="100%">
            <tbody>
                <tr class="event" ng-class="{lab: event.kind==='LAB', tav: event.kind==='TAV'}" ng-repeat="event in $data" data-eventid="{{event.num}}" x-lvl-draggable="true">
                    <td data-title="'Nome evento'" sortable="'name'">{{event.name}}</td>
                    <td data-title="'Posti capi'" sortable="'seats_n_chiefs'">{{event.seats_n_chiefs}}/{{event.max_chiefs_seats}}</td>
                    <td data-title="'Posti ragazzi'" sortable="'seats_n_boys'">{{event.seats_n_boys}}/{{event.max_boys_seats}}</td>
                    <td data-title="'Sottocampo'" sortable="'district'">{{event.district}}</td>
                    <td data-title="'Strada di coraggio'" sortable="'heartbeat'">{{event.heartbeat}}</td>
                    <td data-title="'Dettagli evento'" style="white-space: nowrap;">
                        <span data-toggle="modal" data-target="#event-details" ng-click="selectEvent(event);
                                                " class="btn btn-xs btn-default">Details</span>
                        <span class="label label-default" ng-show="event.state_handicap === 'ENABLED'" title="Evento accessibile anche per disabili">D</span>
                        <span class="label label-default" ng-show="event.state_chief === 'RESERVED'" title="Evento per soli capi">C</span>
                        <span class="label label-default" ng-show="event.state_chief === 'DISABLED'" title="Evento per soli ragazzi">&#571;</span>
                        <span class="label label-success" ng-show="!subscribedEvent(event)" ng-click="subscribe(event)">Subscribe</span>
                        <span class="label label-danger" ng-show="subscribedEvent(event)" ng-click="unsubscribe(event)">Unsubscribe</span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="modal fade" id="event-details" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">{{selectedEvent.name}}</h4>
            </div>
            <div class="modal-body">
                <div class="well">
                    <p ng-repeat="(k,v) in selectedEvent">{{k}}: {{v}}</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

